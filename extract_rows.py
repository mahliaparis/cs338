import csv
import os

encounter_emergency_keys = [717439542,1241700743,1241700743,1765723959,1812726340,1821539450,1913791029,1947961262,1957379110,2436305964,2551965945,2595653433,3580019589,680243186,907149120,673106250,678181959,5721913255,729693418,1236976740,1463415615,1468814448,947395735,1736982654,1753314944,1758513870,1777349226,1792948827,1798629403,1804619260,1013826973,1246622883,1250498635,1909460953,1912487823,1.74E+09,962664910,1.99E+09,2546738389,2556446888,1.79E+09,1801606976,1247076495,2889175766,84041199,1720673572,3892090133,1951921859,4522816875,1788449255,1789936596,1801606976,1844476154,1933423524,1991221850,671347195,671618583,2.59E+09,6.94E+08,2599467564,2888840334,944455823,5.73E+09,5.73E+09,4.20E+09,6.40E+09,4.85E+09,5.40E+09,5.72E+09,6393148779,6738333600,6738166899,6396230183,6734617918,7800070961,9231342271,9595031301,9968796646,9231342280,9985250971,8491211620,8508362462,8861873915,9604587792,9969360411,10366214820,9226209182,10363829206,10367149804,10368855680,9602717937,10746723676,7083253618,8493679876,8493872522,12316546483,12704483162,1740208679,8865663307,12707263667,12710134403,9229436291,9233110153,9233837488,9602717937,9603869895,13284313041,517551656,11527334664,11533923298,11520281024,11528438526,11531844894,11920176525,11921352224,12307853282,679230943,12704000029,12704000029,517046994,13696684816,14098786462,13278953237,13280105780,12704007924,12705647617,12705647617,680165210,683054741,13114696028,13116516062,13280107700,13283654874,14099957708,13695014655,13696682131,1803792783,9971931260,10356040673,10359002259,10364913158,11533923298,11911270931,688780556,692915203,364373039,519270069,671252795,1862026117,1457654449,1463885749,12710675969,680527852,691990701,13690441195,983886922,987672987,1974541690,1727843804,1735926283,1740205036,1757293495,1766491679,1459157685,1803062629,2578650829,2596918471,1013219265,3283781168,3286260040,3574112452,1777350033,1933421444,1685299034,4211114646,4855309347,1788444579,1788879712,1812069365,6396230183,6743229341,2588184533,1933389243,1934978750,1934978750,8141650063,3573867157,1916750016,8860734588,2578646924,1955257077,1959090464,1975525235,1991225288,9225682554,9226209182,9597483794,9602724504,3285204576,2588184533,9983148267,4203835020,11132158788,11524055971,4852234149,5399912957,5401107956,5729053807,2892195943,3574108721,8861873915,8863269891,6399244053,9226209182,9227624379,7433849565,7438053874,7439995665,11533381525,11911441914,9600410088,9975945403,8859549374,12705647617,9986513255,9970288715,7431673228,13699494336,14101361778,10358838334,10358838334,10748724634,11128160827,9224148226,9602724504,9967849725,9968796646,9969818358,9973823741,11911447019,11918111132,11920173013,11930120691,12307852441,10362822302,12715758776,13113987271,11518794504,11524994300,11527367250,13278337942,11129096724,13691457284,14108586901,12316546483,12704479328,13116516062,13117790681,12714429235,13278337942,13690449416,13695014655,13696684816,14105734682,14117814673
]

def extract_rows(readfile, writefile):
    file_exists = os.path.isfile(writefile)
    
    with open(readfile, 'r', newline='') as rf, open(writefile, 'a', newline='') as wf:
        reader = csv.DictReader(rf)
        fieldnames = reader.fieldnames 
        writer = csv.DictWriter(wf, fieldnames=fieldnames)
        
        if not file_exists:
            writer.writeheader()

        lookup = {}
        for row in reader:
            lookup[row['encounter_emergency_key']] = row
        
        for key in encounter_emergency_keys:
            key_str = str(key)
            if key_str in lookup:
                writer.writerow(lookup[key_str])

if __name__ == "__main__":
    readfile = input("enter csv filepath: ")
    writefile = input("enter destination filepath: ")
    extract_rows(readfile, writefile)
    print(f"file created at {writefile}")